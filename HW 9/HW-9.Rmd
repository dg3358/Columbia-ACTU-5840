---
title: "Homework 9 - Predictive Modeling in Finance and Insurance"
author: "Dennis Goldenberg"
date: "2024-04-05"
output: pdf_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r}
cbeDat <- read.table("cbe.dat", header = TRUE)
```

# 1. Exploratory Time Series Analysis

\newpage


# 2. Sample Autocorrelation
The sample lag 2 autocorrelation formula is as follows:
$$
\hat{\rho}_2 = \frac{\sum_{t = 3}^{T}(y_t - \bar{y})(y_{t - 2} - \bar{y})}{\sum_{t = 1}^{T}(y_t - \bar{y})^2}
$$
Note that $\bar{y} = \frac{1 + 1.5 + 1.6 + 1.4 + 1.5 + 1.7}{6} = 1.45$. So, I calculate, using the numbers given:
\begin{align*}
\hat{\rho}_2 &= \frac{(1.6 - 1.45)(1 - 1.45) + (1.4 - 1.45)(1.5 - 1.45) + (1.5 - 1.45)(1.6 - 1.45) + (1.7- 1.45)(1.4 - 1.45)}{(1 - 1.45)^2 + (1.5 - 1.45)^2 + (1.6 - 1.45)^2 + (1.5 - 1.45)^2 + (1.7 - 1.45)^2}\\
&= \frac{-.075}{0.2925} = \mathbf{-0.2564}
\end{align*}

\newpage

# 3. Forecast error
Note that $y_{10} = y_0 + \sum_{i = 1}^{10}c_i$. Since $\bar{c}_{10} = 2$, this means that $\sum_{i = 1}^{10}c_i = 10 * \bar{c}_{10} = 10 * 2 = 20$. Therefore, $y_{10} = y_0 + 20$. From this, and the data given:
$$
y_{19} = y_0 + \sum_{i = 1}^{10}c_i + \sum_{i = 11}^{19}c_i = y_0 + 20 + 26 = y_0 + 46
$$
From the fact that all $c_t$ values are positive, this seems to be a random walk model with drift. Therefore, to develop the estimate of $\hat{y}_{19}$ from $\{y_i: i \in [10]\}$, I estimate the drift parameter $\delta$:
$$
\hat{\delta} = \mathbb{E}\left[\nabla y\right] = \bar{c}_{10} = 2
$$
Therefore, as $\text{Forecast steps} = \ell = 19 - 10 = 9$, I predict $\hat{y}_{19}$ from $y_10$:
$$
\hat{y}_{19} = y_{10} + \ell * \hat{\delta} = y_0 + 20 + 9 * 2 = y_0 + 38 
$$
Thus, the forecast error is:
$$
y_{19} - \hat{y}_{19} = \left(y_0 + 46\right) - \left(y_0 + 38\right) = \mathbf{8} 
$$
\newpage

# 4. Forecast for AR(1) model
I am given that $\bar{y} = 8.01$. I am also given that $\hat{\alpha} = -0.79$ as the estimated parameter from the model. Note that the mean is subtracted before the model is fit; therefore:
$$
\hat{y}_{9} - \bar{y} = \hat{\alpha}^{9 - 7}\left(y_{7} - \bar{y}\right)
$$
So, I solve for $\hat{y}_9$:
$$
\hat{y}_9 = \bar{y} + \hat{\alpha}^{9 - 7}(y_7 - \bar{y}) = 8.01 + (-.79)^2(8.5 - 8.01) = \mathbf{8.315809}
$$

\newpage

# 5. Time Series, AutoRegression, GLS